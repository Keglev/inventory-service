<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DuplicateResourceException.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Inventory Service</a> &gt; <a href="index.source.html" class="el_package">com.smartsupplypro.inventory.exception</a> &gt; <span class="el_source">DuplicateResourceException.java</span></div><h1>DuplicateResourceException.java</h1><pre class="source lang-java linenums">package com.smartsupplypro.inventory.exception;

/**
 * Enterprise exception for resource uniqueness constraint violations.
 * 
 * &lt;p&gt;Indicates business rule enforcement for unique resources including suppliers,
 * inventory items, and operational entities requiring distinct identification.
 * 
 * &lt;p&gt;Key integrations: Entity validation, API error handling, Business rule enforcement.
 * 
 * @author Smart Supply Pro Development Team
 * @version 1.0.0
 * @since 1.0.0
 * @see GlobalExceptionHandler
 */
public class DuplicateResourceException extends RuntimeException {

    private final String resourceType;
    private final String duplicateValue;
    private final String conflictField;

    /**
     * Creates duplicate resource exception with descriptive message.
     * 
     * @param message specific constraint violation details
     */
    public DuplicateResourceException(String message) {
<span class="fc" id="L28">        super(message);</span>
<span class="fc" id="L29">        this.resourceType = null;</span>
<span class="fc" id="L30">        this.duplicateValue = null;</span>
<span class="fc" id="L31">        this.conflictField = null;</span>
<span class="fc" id="L32">    }</span>

    /**
     * Creates duplicate resource exception with detailed context for enhanced error handling.
     * 
     * @param message specific constraint violation details
     * @param resourceType type of resource causing conflict (e.g., &quot;Supplier&quot;, &quot;InventoryItem&quot;)
     * @param conflictField field name causing the duplicate (e.g., &quot;name&quot;, &quot;sku&quot;)
     * @param duplicateValue the conflicting value
     */
    public DuplicateResourceException(String message, String resourceType, String conflictField, String duplicateValue) {
<span class="nc" id="L43">        super(message);</span>
<span class="nc" id="L44">        this.resourceType = resourceType;</span>
<span class="nc" id="L45">        this.conflictField = conflictField;</span>
<span class="nc" id="L46">        this.duplicateValue = duplicateValue;</span>
<span class="nc" id="L47">    }</span>

    // Enterprise utility methods for enhanced error handling

    /**
     * Gets the type of resource involved in the conflict.
     * 
     * @return resource type name or null if not specified
     */
    public String getResourceType() {
<span class="nc" id="L57">        return resourceType;</span>
    }

    /**
     * Gets the field name that caused the duplicate constraint violation.
     * 
     * @return field name or null if not specified
     */
    public String getConflictField() {
<span class="nc" id="L66">        return conflictField;</span>
    }

    /**
     * Gets the duplicate value that caused the constraint violation.
     * 
     * @return duplicate value or null if not specified
     */
    public String getDuplicateValue() {
<span class="nc" id="L75">        return duplicateValue;</span>
    }

    /**
     * Checks if this exception has detailed context information.
     * 
     * @return true if resource type, field, and value are available
     */
    public boolean hasDetailedContext() {
<span class="pc bpc" id="L84" title="5 of 6 branches missed.">        return resourceType != null &amp;&amp; conflictField != null &amp;&amp; duplicateValue != null;</span>
    }

    /**
     * Creates a user-friendly error message for API responses.
     * 
     * @return formatted error message suitable for client display
     */
    public String getClientMessage() {
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if (hasDetailedContext()) {</span>
<span class="nc" id="L94">            return String.format(&quot;%s with %s '%s' already exists&quot;, </span>
                resourceType, conflictField, duplicateValue);
        }
<span class="nc bnc" id="L97" title="All 2 branches missed.">        return getMessage() != null ? getMessage() : &quot;Resource already exists&quot;;</span>
    }

    /**
     * Creates structured error details for API responses.
     * 
     * @return map of error details for client consumption
     */
    public java.util.Map&lt;String, Object&gt; getErrorDetails() {
<span class="nc" id="L106">        java.util.Map&lt;String, Object&gt; details = new java.util.HashMap&lt;&gt;();</span>
<span class="nc" id="L107">        details.put(&quot;errorType&quot;, &quot;DUPLICATE_RESOURCE&quot;);</span>
        
<span class="nc bnc" id="L109" title="All 2 branches missed.">        if (hasDetailedContext()) {</span>
<span class="nc" id="L110">            details.put(&quot;resourceType&quot;, resourceType);</span>
<span class="nc" id="L111">            details.put(&quot;conflictField&quot;, conflictField);</span>
<span class="nc" id="L112">            details.put(&quot;duplicateValue&quot;, duplicateValue);</span>
        }
        
<span class="nc" id="L115">        details.put(&quot;message&quot;, getClientMessage());</span>
<span class="nc" id="L116">        return details;</span>
    }

    // Static factory methods for common scenarios

    /**
     * Creates exception for supplier name conflicts.
     * 
     * @param supplierName the duplicate supplier name
     * @return configured exception instance
     */
    public static DuplicateResourceException supplierName(String supplierName) {
<span class="nc" id="L128">        return new DuplicateResourceException(</span>
            &quot;Supplier name already exists: &quot; + supplierName,
            &quot;Supplier&quot;,
            &quot;name&quot;,
            supplierName
        );
    }

    /**
     * Creates exception for inventory item SKU conflicts.
     * 
     * @param sku the duplicate SKU value
     * @return configured exception instance
     */
    public static DuplicateResourceException inventoryItemSku(String sku) {
<span class="nc" id="L143">        return new DuplicateResourceException(</span>
            &quot;Inventory item SKU already exists: &quot; + sku,
            &quot;InventoryItem&quot;,
            &quot;sku&quot;,
            sku
        );
    }

    /**
     * Creates exception for inventory item name conflicts.
     * 
     * @param itemName the duplicate item name
     * @return configured exception instance
     */
    public static DuplicateResourceException inventoryItemName(String itemName) {
<span class="nc" id="L158">        return new DuplicateResourceException(</span>
            &quot;Inventory item name already exists: &quot; + itemName,
            &quot;InventoryItem&quot;,
            &quot;name&quot;,
            itemName
        );
    }
}


</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>