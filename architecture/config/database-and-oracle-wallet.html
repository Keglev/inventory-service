<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Backend ¬∑
config/database-and-oracle-wallet ¬∑ Smart Supply Pro Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSS lives under /templates on GitHub Pages for inventory-service repo -->
  <link rel="stylesheet" href="/inventory-service/templates/docs.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <a href="/inventory-service/" class="logo">üì¶ Smart Supply Pro Docs</a>
      <nav class="nav">
      <a href="/inventory-service/architecture/index.html">Backend Architecture</a>
      <a href="/inventory-service/architecture/overview-de.html">Backend Architektur Deutsch</a>
        <!-- Future: <a href="/inventory-service/frontend/architecture/overview.html">Frontend</a> -->
        <a href="/inventory-service/backend/api/index.html">Backend API</a>
        <!-- Future: <a href="/inventory-service/frontend/api/index.html">Frontend API</a> -->
        <a href="/inventory-service/backend/coverage/index.html">Backend Coverage</a>
        <!-- Future: <a href="/inventory-service/frontend/coverage/index.html">Frontend Coverage</a> -->
      </nav>
    </div>
  </header>

  <main class="layout">
    <aside class="sidebar">
      <h2>Backend</h2>
      <ul>
        <li><a href="/inventory-service/architecture/overview.html">Architecture Overview</a></li>
        <li><a href="/inventory-service/architecture/overview-de.html">Architektur-√úberblick</a></li>
        <li><a href="/inventory-service/architecture/layers/overview.html">Layers</a></li>
        <li><a href="/inventory-service/architecture/model/index.html">Data Models</a></li>
        <li><a href="/inventory-service/architecture/enums/index.html">Enums</a></li>
        <li><a href="/inventory-service/architecture/dto/index.html">DTOs</a></li>
        <li><a href="/inventory-service/architecture/config/index.html">Config</a></li>
        <li><a href="/inventory-service/architecture/controller/index.html">Controllers</a></li>
        <li><a href="/inventory-service/architecture/security/index.html">Security</a></li>
        <li><a href="/inventory-service/architecture/deployment/index.html">Deployment</a></li>
        <li><a href="/inventory-service/architecture/exception/index.html">Exception Handling</a></li>
        <li><a href="/inventory-service/architecture/integration/index.html">Integration</a></li>
        <li><a href="/inventory-service/architecture/repository/index.html">Repository</a></li>
        <li><a href="/inventory-service/architecture/resources/index.html">Resources</a></li>
        <li><a href="/inventory-service/architecture/validation/index.html">Validation</a></li>
        <li><a href="/inventory-service/architecture/testing/index.html">Testing</a></li>
        <li><a href="/inventory-service/architecture/diagrams/index.html">Diagrams</a></li>
      </ul>

      <h2>Frontend</h2>
      <ul>
        <h3>Docs coming soon</h3>
        <!-- Future <li><a href="/inventory-service/frontend/architecture/overview.html">Architecture Overview</a></li> -->
      </ul>

      <h2>Quality</h2>
      <ul>
        <li><a href="/inventory-service/backend/api/index.html">API Reference</a></li>
        <li><a href="/inventory-service/backend/coverage/index.html">JaCoCo Coverage</a></li>
      </ul>
    </aside>

    <section class="content">
            <nav class="toc">
        <h2>On this page</h2>
        <ul>
        <li><a href="#database-and-oracle-wallet-configuration"
        id="toc-database-and-oracle-wallet-configuration">Database and
        Oracle Wallet Configuration</a>
        <ul>
        <li><a href="#overview" id="toc-overview">Overview</a></li>
        <li><a href="#spring-datasource-configuration"
        id="toc-spring-datasource-configuration">Spring Datasource
        Configuration</a>
        <ul>
        <li><a href="#base-configuration-application.yml"
        id="toc-base-configuration-application.yml">Base Configuration
        (application.yml)</a></li>
        <li><a href="#production-configuration-application-prod.yml"
        id="toc-production-configuration-application-prod.yml">Production
        Configuration (application-prod.yml)</a></li>
        </ul></li>
        <li><a href="#database-url-format"
        id="toc-database-url-format">Database URL Format</a>
        <ul>
        <li><a href="#standard-oracle-connection"
        id="toc-standard-oracle-connection">Standard Oracle
        Connection</a></li>
        <li><a href="#oracle-autonomous-database-cloud"
        id="toc-oracle-autonomous-database-cloud">Oracle Autonomous
        Database (Cloud)</a></li>
        <li><a href="#oracle-database-in-docker-local"
        id="toc-oracle-database-in-docker-local">Oracle Database in
        Docker (Local)</a></li>
        <li><a href="#oracle-wallet-connection"
        id="toc-oracle-wallet-connection">Oracle Wallet
        Connection</a></li>
        </ul></li>
        <li><a href="#oracle-wallet-setup"
        id="toc-oracle-wallet-setup">Oracle Wallet Setup</a>
        <ul>
        <li><a href="#what-is-oracle-wallet"
        id="toc-what-is-oracle-wallet">What is Oracle Wallet?</a></li>
        <li><a href="#wallet-location-in-this-project"
        id="toc-wallet-location-in-this-project">Wallet Location in This
        Project</a></li>
        <li><a href="#decoding-the-wallet"
        id="toc-decoding-the-wallet">Decoding the Wallet</a></li>
        <li><a href="#spring-boot-with-wallet"
        id="toc-spring-boot-with-wallet">Spring Boot with
        Wallet</a></li>
        </ul></li>
        <li><a href="#database-selection-by-profile"
        id="toc-database-selection-by-profile">Database Selection by
        Profile</a>
        <ul>
        <li><a href="#test-profile-application-test.yml"
        id="toc-test-profile-application-test.yml">Test Profile
        (application-test.yml)</a></li>
        <li><a href="#default-profile-application.yml"
        id="toc-default-profile-application.yml">Default Profile
        (application.yml)</a></li>
        <li><a href="#production-profile-application-prod.yml"
        id="toc-production-profile-application-prod.yml">Production
        Profile (application-prod.yml)</a></li>
        </ul></li>
        <li><a href="#hibernate-configuration"
        id="toc-hibernate-configuration">Hibernate Configuration</a>
        <ul>
        <li><a href="#base-all-profiles" id="toc-base-all-profiles">Base
        (all profiles)</a></li>
        <li><a href="#production"
        id="toc-production">Production</a></li>
        <li><a href="#test" id="toc-test">Test</a></li>
        </ul></li>
        <li><a href="#connection-string-examples"
        id="toc-connection-string-examples">Connection String
        Examples</a>
        <ul>
        <li><a href="#local-development"
        id="toc-local-development">Local Development</a></li>
        <li><a href="#testing" id="toc-testing">Testing</a></li>
        <li><a href="#production-fly.io"
        id="toc-production-fly.io">Production (Fly.io)</a></li>
        <li><a href="#docker-with-oracle"
        id="toc-docker-with-oracle">Docker with Oracle</a></li>
        </ul></li>
        <li><a href="#troubleshooting"
        id="toc-troubleshooting">Troubleshooting</a>
        <ul>
        <li><a href="#ora-17008-closed-connection"
        id="toc-ora-17008-closed-connection">ORA-17008: Closed
        Connection</a></li>
        <li><a href="#cannot-create-connection"
        id="toc-cannot-create-connection">Cannot Create
        Connection</a></li>
        <li><a href="#h2-database-locked" id="toc-h2-database-locked">H2
        Database Locked</a></li>
        <li><a href="#no-suitable-driver" id="toc-no-suitable-driver">No
        Suitable Driver</a></li>
        </ul></li>
        <li><a href="#summary" id="toc-summary">Summary</a></li>
        </ul></li>
        </ul>
      </nav>
      
      <article class="doc-body">
        <p><a href="./index.html">‚¨ÖÔ∏è Back to Config Overview</a></p>
        <h1 id="database-and-oracle-wallet-configuration">Database and
        Oracle Wallet Configuration</h1>
        <h2 id="overview">Overview</h2>
        <p>Database configuration in the Inventory Service spans:</p>
        <ul>
        <li><strong>Spring Data</strong> properties in
        <code>application*.yml</code></li>
        <li><strong>Oracle JDBC Driver</strong>
        (<code>oracle.jdbc.OracleDriver</code>)</li>
        <li><strong>Oracle Wallet</strong> for secure credential
        storage</li>
        <li><strong>Connection pooling</strong> (HikariCP) with
        Oracle-specific tuning</li>
        </ul>
        <p>This document covers how these pieces work together to
        establish a secure, production-grade database connection.</p>
        <hr />
        <h2 id="spring-datasource-configuration">Spring Datasource
        Configuration</h2>
        <h3 id="base-configuration-application.yml">Base Configuration
        (application.yml)</h3>
        <div class="sourceCode" id="cb1"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${DB_URL}</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> ${DB_USER}</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> ${DB_PASS}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver-class-name</span><span class="kw">:</span><span class="at"> oracle.jdbc.OracleDriver</span></span></code></pre></div>
        <p><strong>Key points:</strong></p>
        <ul>
        <li><strong>No hardcoded credentials</strong>: All sensitive
        values come from environment variables</li>
        <li><strong>Oracle JDBC driver</strong> is declared explicitly
        (included in <code>pom.xml</code>)</li>
        <li><strong>Requires <code>DB_URL</code>, <code>DB_USER</code>,
        <code>DB_PASS</code> environment variables</strong> to be
        set</li>
        </ul>
        <h3
        id="production-configuration-application-prod.yml">Production
        Configuration (application-prod.yml)</h3>
        <div class="sourceCode" id="cb2"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${DB_URL}</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> ${DB_USER}</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> ${DB_PASS}</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver-class-name</span><span class="kw">:</span><span class="at"> oracle.jdbc.OracleDriver</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hikari</span><span class="kw">:</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">connection-timeout</span><span class="kw">:</span><span class="at"> </span><span class="dv">30000</span><span class="co">        # 30 seconds to establish connection</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">validation-timeout</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span><span class="co">         # 5 seconds to validate</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">maximum-pool-size</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span><span class="co">             # Small pool for 1GB RAM (Fly.io)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">minimum-idle</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span><span class="co">                  # Keep 2 idle connections ready</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max-lifetime</span><span class="kw">:</span><span class="at"> </span><span class="dv">240000</span><span class="co">             # 4 minutes (less than Oracle&#39;s 5-min timeout)</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">idle-timeout</span><span class="kw">:</span><span class="at"> </span><span class="dv">180000</span><span class="co">             # 3 minutes before evicting idle connections</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">connection-test-query</span><span class="kw">:</span><span class="at"> SELECT 1 FROM DUAL</span><span class="co">  # Oracle health check</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">leak-detection-threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">60000</span><span class="co">  # 60 seconds - flag leaked connections</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">keepalive-time</span><span class="kw">:</span><span class="at"> </span><span class="dv">120000</span><span class="co">           # 2-min keepalive ping</span></span></code></pre></div>
        <h4 id="why-these-settings">Why These Settings?</h4>
        <p>Oracle Autonomous Database is aggressive about closing idle
        connections (5-minute timeout). These settings prevent
        <code>ORA-17008: Closed connection</code> errors:</p>
        <table>
        <colgroup>
        <col style="width: 37%" />
        <col style="width: 29%" />
        <col style="width: 33%" />
        </colgroup>
        <thead>
        <tr class="header">
        <th>Setting</th>
        <th>Value</th>
        <th>Reason</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td><code>max-lifetime</code></td>
        <td>240000 (4 min)</td>
        <td>Close connections before Oracle does</td>
        </tr>
        <tr class="even">
        <td><code>idle-timeout</code></td>
        <td>180000 (3 min)</td>
        <td>Evict idle connections quickly</td>
        </tr>
        <tr class="odd">
        <td><code>keepalive-time</code></td>
        <td>120000 (2 min)</td>
        <td>Ping connections periodically</td>
        </tr>
        <tr class="even">
        <td><code>connection-test-query</code></td>
        <td><code>SELECT 1 FROM DUAL</code></td>
        <td>Validate Oracle connections</td>
        </tr>
        <tr class="odd">
        <td><code>maximum-pool-size</code></td>
        <td>5</td>
        <td>Limited by Fly.io‚Äôs 1GB RAM</td>
        </tr>
        </tbody>
        </table>
        <hr />
        <h2 id="database-url-format">Database URL Format</h2>
        <h3 id="standard-oracle-connection">Standard Oracle
        Connection</h3>
        <pre><code>jdbc:oracle:thin:@hostname:port:sid
jdbc:oracle:thin:@hostname:port/service-name</code></pre>
        <h3 id="oracle-autonomous-database-cloud">Oracle Autonomous
        Database (Cloud)</h3>
        <pre><code>jdbc:oracle:thin:@adb-nxxxxxx.database.oraclecloud.com:1521/xxxxx_medium.cloud.oracle.com</code></pre>
        <h3 id="oracle-database-in-docker-local">Oracle Database in
        Docker (Local)</h3>
        <pre><code>jdbc:oracle:thin:@localhost:1521/xe</code></pre>
        <h3 id="oracle-wallet-connection">Oracle Wallet Connection</h3>
        <pre><code>jdbc:oracle:thin:@inventorydb_medium?TNS_ADMIN=/opt/oracle_wallet</code></pre>
        <ul>
        <li><strong><code>TNS_ADMIN</code></strong> environment variable
        points to wallet directory</li>
        <li>Wallet contains encrypted credentials and connection
        details</li>
        </ul>
        <hr />
        <h2 id="oracle-wallet-setup">Oracle Wallet Setup</h2>
        <h3 id="what-is-oracle-wallet">What is Oracle Wallet?</h3>
        <p>Oracle Wallet is a encrypted file containing: - Database
        credentials (username, password) - Connection details (host,
        port, service name) - SSL certificates (for secure
        connections)</p>
        <p>It eliminates hardcoding credentials in the connection
        string.</p>
        <h3 id="wallet-location-in-this-project">Wallet Location in This
        Project</h3>
        <pre><code>oracle_wallet/
‚îú‚îÄ‚îÄ flysecrets.env                    # Environment variables for Fly
‚îú‚îÄ‚îÄ oracle_wallet_b64.txt             # Base64-encoded wallet (safe for Git)
‚îî‚îÄ‚îÄ TNS_ADMIN/
    ‚îú‚îÄ‚îÄ cwallet.sso                   # Encrypted wallet file
    ‚îú‚îÄ‚îÄ ewallet.p12                   # PKCS12 format wallet
    ‚îú‚îÄ‚îÄ sqlnet.ora                    # Oracle client config
    ‚îú‚îÄ‚îÄ tnsnames.ora                  # Alias definitions
    ‚îî‚îÄ‚îÄ ... (other wallet files)</code></pre>
        <h3 id="decoding-the-wallet">Decoding the Wallet</h3>
        <p>The wallet is stored as <strong>Base64</strong> in Git for
        safety:</p>
        <div class="sourceCode" id="cb8"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decode the wallet</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">base64</span> <span class="at">-d</span> oracle_wallet/oracle_wallet_b64.txt <span class="op">&gt;</span> oracle_wallet.tar.gz</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xzf</span> oracle_wallet.tar.gz</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set environment variable for Oracle client</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">TNS_ADMIN</span><span class="op">=</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/TNS_ADMIN</span></code></pre></div>
        <h3 id="spring-boot-with-wallet">Spring Boot with Wallet</h3>
        <div class="sourceCode" id="cb9"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> jdbc:oracle:thin:@inventorydb_medium?TNS_ADMIN=/opt/oracle_wallet</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    # Username and password from wallet, not connection string</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> ${DB_USER}</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> ${DB_PASS}</span></span></code></pre></div>
        <p>The wallet handles encryption; Spring just provides
        credentials.</p>
        <hr />
        <h2 id="database-selection-by-profile">Database Selection by
        Profile</h2>
        <h3 id="test-profile-application-test.yml">Test Profile
        (application-test.yml)</h3>
        <div class="sourceCode" id="cb10"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> jdbc:h2:mem:ssp;MODE=Oracle;DATABASE_TO_UPPER=true;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver-class-name</span><span class="kw">:</span><span class="at"> org.h2.Driver</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> sa</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span></span></code></pre></div>
        <p><strong>Why H2?</strong> - In-memory database - Fast startup
        (no network call) - Oracle-compatible mode
        (<code>MODE=Oracle</code>) - Isolated per test run - No
        credentials needed</p>
        <h3 id="default-profile-application.yml">Default Profile
        (application.yml)</h3>
        <div class="sourceCode" id="cb11"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${DB_URL}</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver-class-name</span><span class="kw">:</span><span class="at"> oracle.jdbc.OracleDriver</span></span></code></pre></div>
        <p><strong>Expects:</strong> - Environment variables:
        <code>DB_URL</code>, <code>DB_USER</code>, <code>DB_PASS</code>
        - Requires manual setup (local PostgreSQL/Oracle instance)</p>
        <h3 id="production-profile-application-prod.yml">Production
        Profile (application-prod.yml)</h3>
        <div class="sourceCode" id="cb12"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">datasource</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${DB_URL}</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver-class-name</span><span class="kw">:</span><span class="at"> oracle.jdbc.OracleDriver</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hikari</span><span class="kw">:</span><span class="at"> (pool settings above)</span></span></code></pre></div>
        <p><strong>Uses:</strong> - Oracle Autonomous Database on cloud
        - Credentials from secure environment (Fly.io secrets) -
        Connection pool tuning for production</p>
        <hr />
        <h2 id="hibernate-configuration">Hibernate Configuration</h2>
        <h3 id="base-all-profiles">Base (all profiles)</h3>
        <div class="sourceCode" id="cb13"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">jpa</span><span class="kw">:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hibernate</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ddl-auto</span><span class="kw">:</span><span class="at"> none</span><span class="co">                  # Don&#39;t auto-create schema</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">show-sql</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="co">                    # Log SQL (disable in prod)</span></span></code></pre></div>
        <h3 id="production">Production</h3>
        <div class="sourceCode" id="cb14"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">jpa</span><span class="kw">:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hibernate</span><span class="kw">:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ddl-auto</span><span class="kw">:</span><span class="at"> update</span><span class="co">                # Update schema if needed</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">show-sql</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="co">                   # Disable for performance</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">hibernate</span><span class="kw">:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">dialect</span><span class="kw">:</span><span class="at"> org.hibernate.dialect.OracleDialect</span></span></code></pre></div>
        <h3 id="test">Test</h3>
        <div class="sourceCode" id="cb15"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spring</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">jpa</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">database-platform</span><span class="kw">:</span><span class="at"> org.hibernate.dialect.H2Dialect</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hibernate</span><span class="kw">:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ddl-auto</span><span class="kw">:</span><span class="at"> create-drop</span><span class="co">           # Fresh schema each test</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">show-sql</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">hibernate</span><span class="kw">:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;[format_sql]&#39;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
        <hr />
        <h2 id="connection-string-examples">Connection String
        Examples</h2>
        <h3 id="local-development">Local Development</h3>
        <div class="sourceCode" id="cb16"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">DB_URL</span><span class="op">=</span><span class="st">&quot;jdbc:oracle:thin:@localhost:1521/xe&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">DB_USER</span><span class="op">=</span><span class="st">&quot;inventory_admin&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">DB_PASS</span><span class="op">=</span><span class="st">&quot;your-password&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SPRING_PROFILES_ACTIVE</span><span class="op">=</span><span class="st">&quot;&quot;</span>  <span class="co"># No profile = default</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> spring-boot:run</span></code></pre></div>
        <h3 id="testing">Testing</h3>
        <div class="sourceCode" id="cb17"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SPRING_PROFILES_ACTIVE</span><span class="op">=</span><span class="st">&quot;test&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> clean test</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H2 handles DB; no env vars needed</span></span></code></pre></div>
        <h3 id="production-fly.io">Production (Fly.io)</h3>
        <div class="sourceCode" id="cb18"><pre
        class="sourceCode toml"><code class="sourceCode toml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fly.toml</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[env]</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">SPRING_PROFILES_ACTIVE</span> <span class="op">=</span> <span class="st">&quot;prod&quot;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Secrets set separately:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fly secrets set DB_URL=&quot;jdbc:oracle:thin:@...&quot; DB_USER=&quot;...&quot; DB_PASS=&quot;...&quot;</span></span></code></pre></div>
        <h3 id="docker-with-oracle">Docker with Oracle</h3>
        <div class="sourceCode" id="cb19"><pre
        class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> eclipse-temurin:17-jre</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> target/inventory-service-*.jar app.jar</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> oracle_wallet /opt/oracle_wallet</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ENTRYPOINT</span> [<span class="st">&quot;java&quot;</span>, <span class="st">&quot;-Dspring.profiles.active=prod&quot;</span>, <span class="st">&quot;-jar&quot;</span>, <span class="st">&quot;/app.jar&quot;</span>]</span></code></pre></div>
        <div class="sourceCode" id="cb20"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="dt">\</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> DB_URL=<span class="st">&quot;jdbc:oracle:thin:@oracle-cloud:1521/xe&quot;</span> <span class="dt">\</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> DB_USER=<span class="st">&quot;admin&quot;</span> <span class="dt">\</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> DB_PASS=<span class="st">&quot;***&quot;</span> <span class="dt">\</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  inventory-service:latest</span></code></pre></div>
        <hr />
        <h2 id="troubleshooting">Troubleshooting</h2>
        <h3 id="ora-17008-closed-connection">ORA-17008: Closed
        Connection</h3>
        <p><strong>Cause:</strong> Connection pool doesn‚Äôt refresh
        before Oracle closes idle connections.</p>
        <p><strong>Solution:</strong> Adjust
        <code>application-prod.yml</code>:</p>
        <div class="sourceCode" id="cb21"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hikari</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">max-lifetime</span><span class="kw">:</span><span class="at"> </span><span class="dv">240000</span><span class="co">              # 4 minutes</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">keepalive-time</span><span class="kw">:</span><span class="at"> </span><span class="dv">120000</span><span class="co">            # 2-min pings</span></span></code></pre></div>
        <h3 id="cannot-create-connection">Cannot Create Connection</h3>
        <p><strong>Cause:</strong> Missing environment variables or
        invalid connection string.</p>
        <p><strong>Check:</strong></p>
        <div class="sourceCode" id="cb22"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify env vars are set</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$DB_URL</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$DB_USER</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Test connection manually</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="ex">sqlplus</span> <span class="va">$DB_USER</span>/<span class="va">$DB_PASS</span>@<span class="va">$DB_URL</span></span></code></pre></div>
        <h3 id="h2-database-locked">H2 Database Locked</h3>
        <p><strong>Cause:</strong> Multiple test processes accessing
        same in-memory DB.</p>
        <p><strong>Solution:</strong> Configure test profile to allow
        multiple connections:</p>
        <div class="sourceCode" id="cb23"><pre
        class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">url</span><span class="kw">:</span><span class="at"> jdbc:h2:mem:ssp;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</span></span></code></pre></div>
        <h3 id="no-suitable-driver">No Suitable Driver</h3>
        <p><strong>Cause:</strong> JDBC driver not in classpath.</p>
        <p><strong>Check pom.xml:</strong></p>
        <div class="sourceCode" id="cb24"><pre
        class="sourceCode xml"><code class="sourceCode xml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">dependency</span>&gt;</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">groupId</span>&gt;com.oracle.database.jdbc&lt;/<span class="kw">groupId</span>&gt;</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">artifactId</span>&gt;ojdbc11&lt;/<span class="kw">artifactId</span>&gt;</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">dependency</span>&gt;</span></code></pre></div>
        <hr />
        <h2 id="summary">Summary</h2>
        <table>
        <colgroup>
        <col style="width: 32%" />
        <col style="width: 24%" />
        <col style="width: 44%" />
        </colgroup>
        <thead>
        <tr class="header">
        <th>Aspect</th>
        <th>Test</th>
        <th>Production</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td><strong>Database</strong></td>
        <td>H2 in-memory</td>
        <td>Oracle Autonomous DB</td>
        </tr>
        <tr class="even">
        <td><strong>URL</strong></td>
        <td><code>jdbc:h2:mem:...</code></td>
        <td><code>jdbc:oracle:thin:@host:port/sid</code></td>
        </tr>
        <tr class="odd">
        <td><strong>Driver</strong></td>
        <td><code>org.h2.Driver</code></td>
        <td><code>oracle.jdbc.OracleDriver</code></td>
        </tr>
        <tr class="even">
        <td><strong>Credentials</strong></td>
        <td>Hardcoded (safe for test)</td>
        <td>From environment (secure)</td>
        </tr>
        <tr class="odd">
        <td><strong>Pool Size</strong></td>
        <td>Default</td>
        <td>5 (Fly.io limited)</td>
        </tr>
        <tr class="even">
        <td><strong>Wallet</strong></td>
        <td>N/A</td>
        <td><code>/opt/oracle_wallet</code></td>
        </tr>
        <tr class="odd">
        <td><strong>DDL Auto</strong></td>
        <td><code>create-drop</code></td>
        <td><code>update</code></td>
        </tr>
        <tr class="even">
        <td><strong>Show SQL</strong></td>
        <td>true</td>
        <td>false</td>
        </tr>
        </tbody>
        </table>
        <hr />
        <p><a href="./index.html">‚¨ÖÔ∏è Back to Config Overview</a></p>
      </article>
    </section>
  </main>

  <footer class="footer">
    Smart Supply Pro ¬∑ Generated by Docs Pipeline
  </footer>

  <!-- Mermaid for diagrams in ```mermaid``` blocks -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true });</script>
</body>
</html>
