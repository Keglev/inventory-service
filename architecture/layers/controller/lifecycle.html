<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Backend Â·
layers/controller/lifecycle Â· Smart Supply Pro Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSS lives under /templates on GitHub Pages for inventory-service repo -->
  <link rel="stylesheet" href="/inventory-service/templates/docs.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <a href="/inventory-service/" class="logo">ğŸ“¦ Smart Supply Pro Docs</a>
      <nav class="nav">
      <a href="/inventory-service/architecture/index.html">Backend Architecture</a>
        <!-- Future: <a href="/inventory-service/frontend/architecture/overview.html">Frontend</a> -->
        <a href="/inventory-service/backend/api/index.html">Backend API</a>
        <!-- Future: <a href="/inventory-service/frontend/api/index.html">Frontend API</a> -->
        <a href="/inventory-service/backend/coverage/index.html">Backend Coverage</a>
        <!-- Future: <a href="/inventory-service/frontend/coverage/index.html">Frontend Coverage</a> -->
      </nav>
    </div>
  </header>

  <main class="layout">
    <aside class="sidebar">
      <h2>Backend</h2>
      <ul>
        <li><a href="/inventory-service/architecture/overview.html">Architecture Overview</a></li>
        <li><a href="/inventory-service/architecture/overview-de.html">Architektur-Ãœberblick</a></li>
        <li><a href="/inventory-service/architecture/layers/overview.html">Layers</a></li>
        <li><a href="/inventory-service/architecture/security.html">Security</a></li>
        <li><a href="/inventory-service/architecture/deployment.html">Deployment</a></li>
      </ul>

      <h2>Frontend</h2>
      <ul>
        <h3>Docs coming soon</h3>
        <!-- Future <li><a href="/inventory-service/frontend/architecture/overview.html">Architecture Overview</a></li> -->
      </ul>

      <h2>Quality</h2>
      <ul>
        <li><a href="/inventory-service/backend/api/index.html">API Reference</a></li>
        <li><a href="/inventory-service/backend/coverage/index.html">JaCoCo Coverage</a></li>
      </ul>
    </aside>

    <section class="content">
            <nav class="toc">
        <h2>On this page</h2>
        <ul>
        <li><a href="#requestresponse-lifecycle"
        id="toc-requestresponse-lifecycle">Request/Response
        Lifecycle</a>
        <ul>
        <li><a href="#complete-request-flow"
        id="toc-complete-request-flow">Complete Request Flow</a></li>
        <li><a href="#request-validation-checkpoint"
        id="toc-request-validation-checkpoint">Request Validation
        Checkpoint</a></li>
        <li><a href="#response-path" id="toc-response-path">Response
        Path</a></li>
        <li><a href="#error-handling-path"
        id="toc-error-handling-path">Error Handling Path</a></li>
        </ul></li>
        </ul>
      </nav>
      
      <article class="doc-body">
        <p><a href="./index.html">â¬…ï¸ Back to Controller Index</a></p>
        <h1 id="requestresponse-lifecycle">Request/Response
        Lifecycle</h1>
        <p>The complete flow of an HTTP request through the Controller
        Layer.</p>
        <h2 id="complete-request-flow">Complete Request Flow</h2>
        <p>Hereâ€™s how a typical request (creating a supplier) flows
        through all layers:</p>
        <pre><code>1. HTTP Request arrives at Spring DispatcherServlet
   POST /api/suppliers
   Content-Type: application/json
   Authorization: Bearer &lt;token&gt;
   { &quot;name&quot;: &quot;ACME Corp&quot;, ... }
   â†“
2. Request routing matches URL pattern to controller method
   DispatcherServlet identifies SupplierController.create()
   â†“
3. Spring Security checks @PreAuthorize annotation
   @PreAuthorize(&quot;hasRole(&#39;ADMIN&#39;)&quot;)
   â”œâ”€ If not authorized â†’ AccessDeniedException â†’ 403 Forbidden
   â””â”€ If authorized â†’ Continue
   â†“
4. @Valid triggers DTO field validation
   Validates CreateSupplierDTO fields
   â”œâ”€ @NotBlank on name field
   â”œâ”€ @Email on contactEmail field
   â””â”€ All constraints checked
   â†“
   If validation fails:
   â”œâ”€ MethodArgumentNotValidException thrown
   â”œâ”€ GlobalExceptionHandler catches
   â””â”€ Returns 400 Bad Request
   â†“
5. Jackson deserializes request body JSON â†’ DTO
   { &quot;name&quot;: &quot;ACME Corp&quot;, ... }
      â†“
   CreateSupplierDTO object (fully populated)
   â†“
6. Controller method executes
   supplierService.create(dto)
   â†“
7. Service layer executes
   - Service validator checks business rules
   - Service calls repository
   - Repository persists to database
   - Service returns DTO
   â†“
   If exception in service:
   â”œâ”€ Service throws exception
   â”œâ”€ GlobalExceptionHandler catches
   â””â”€ Returns 4xx or 5xx error
   â†“
8. Controller receives SupplierDTO from service
   Has: id, name, contactName, etc.
   â†“
9. Jackson serializes DTO â†’ JSON response body
   SupplierDTO object
      â†“
   { &quot;id&quot;: &quot;abc123&quot;, &quot;name&quot;: &quot;ACME Corp&quot;, ... }
   â†“
10. Controller builds ResponseEntity with status code
    ResponseEntity.created(location).body(created)
    â”œâ”€ Status: 201 CREATED
    â”œâ”€ Location header: /api/suppliers/abc123
    â””â”€ Body: Serialized DTO
    â†“
11. HTTP Response returned to client
    HTTP/1.1 201 Created
    Location: /api/suppliers/abc123
    Content-Type: application/json
    { &quot;id&quot;: &quot;abc123&quot;, &quot;name&quot;: &quot;ACME Corp&quot;, ... }</code></pre>
        <h2 id="request-validation-checkpoint">Request Validation
        Checkpoint</h2>
        <pre><code>Request JSON received
    â†“
DispatcherServlet routes to controller
    â†“
Spring Security @PreAuthorize check
    â”œâ”€ Not authenticated? â†’ 401 Unauthorized
    â”œâ”€ Not authorized? â†’ 403 Forbidden
    â””â”€ Authorized? â†’ Continue
    â†“
Jackson deserializes JSON â†’ DTO
    â†“
@Valid annotation triggers field validation
    â”œâ”€ Any constraint violations? â†’ 400 Bad Request
    â””â”€ All valid? â†’ Continue
    â†“
Controller method invoked</code></pre>
        <h2 id="response-path">Response Path</h2>
        <pre><code>Service returns domain DTO
    â†“
Controller wraps in ResponseEntity
    â”œâ”€ Set status code (200, 201, 204, etc.)
    â”œâ”€ Add headers if needed (Location, etc.)
    â””â”€ Add body if applicable
    â†“
Jackson serializes DTO â†’ JSON
    â†“
HTTP Response to client
    â”œâ”€ Status line
    â”œâ”€ Headers
    â””â”€ JSON body</code></pre>
        <h2 id="error-handling-path">Error Handling Path</h2>
        <pre><code>Any layer throws exception
    â†“
Exception propagates up to GlobalExceptionHandler
    â†“
Handler identifies exception type
    â”œâ”€ IllegalArgumentException â†’ 400 Bad Request
    â”œâ”€ NoSuchElementException â†’ 404 Not Found
    â”œâ”€ IllegalStateException â†’ 409 Conflict
    â”œâ”€ AccessDeniedException â†’ 403 Forbidden
    â””â”€ Generic Exception â†’ 500 Internal Server Error
    â†“
Handler builds ErrorResponse object
    â”œâ”€ Code: error type (BAD_REQUEST, NOT_FOUND, etc.)
    â”œâ”€ Message: human-readable explanation
    â”œâ”€ Path: request URL
    â””â”€ Timestamp: when error occurred
    â†“
Jackson serializes ErrorResponse â†’ JSON
    â†“
HTTP Error Response to client
    â”œâ”€ Appropriate status code (400, 404, 409, etc.)
    â””â”€ JSON body with error details</code></pre>
        <hr />
        <p><a href="./index.html">â¬…ï¸ Back to Controller Index</a></p>
      </article>
    </section>
  </main>

  <footer class="footer">
    Smart Supply Pro Â· Generated by Docs Pipeline
  </footer>

  <!-- Mermaid for diagrams in ```mermaid``` blocks -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true });</script>
</body>
</html>
